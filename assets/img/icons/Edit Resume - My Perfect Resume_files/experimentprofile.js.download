function _equalsIgnoreCase(e,t){return e&&t&&e.toLowerCase()==t.toLowerCase()||!1}window.Profile=window.Profile||{},window.globalCompVars=window.globalCompVars||{},Profile.isMagenta=false,Profile.profileStorageKey=Profile.isMagenta?"UserPersona":"UserProfile",window.Profile.BaseUrl=window.location.origin,Profile.isStorageEnabled=!0,"object"==typeof PS&&"object"==typeof PS.Utility&&"function"==typeof PS.Utility.isStorageEnabled&&(Profile.isStorageEnabled=PS.StrgEnabled),window.Profile.Init=function(e,t,r,i,a,o){window.Profile.UpdateProfile({PremiumStatus:"Not Started",VisitedStages:[],Country:i,Role:r,UserId:e,LayerId:t,Device:a},o)},window.Profile.InitAsync=function(i,a,o,n,l,s){return new Promise((t,r)=>{try{var e={PremiumStatus:"Not Started",VisitedStages:[],Country:n,Role:o,UserId:i,LayerId:a,Device:l};window.Profile.UpdateProfile(e,e=>{t(e),s&&"function"==typeof s&&s()})}catch(e){r(e)}})},window.Profile.ConductExperiment=function(e,t){var r=0,i=setDefaultValues(e),a=Profile.isStorageEnabled?JSON.parse(localStorage.getItem(Profile.profileStorageKey)):null;if(!a||!i.IsBackend&&!a.LayerId)return r;var o=a&&a.VisitedStages&&0<a.VisitedStages.length?a.VisitedStages.filter(function(e){return e.userStageId==i.StageID&&(""===i.ProductCD||e.productCD==i.ProductCD)}):[],n=!(!i.UseRole||"Guest"==i.UseRole);if(i.conductforguestusers&&n)return r;if(!e.ignoreStageCheck&&!window.Profile.CheckStageEligibility(i.StageID,i.ProductCD))return r;if(e.isRCExperiment&&checktrialPurchaseDate(a.TrialPurchaseDate))return r;var n=!1,n=i.ExcludedCountry?-1==i.ExcludedCountry.indexOf(a.Country):i.Country&&(-1<i.Country.indexOf(a.Country)||i.Country.toString().toUpperCase().includes("ALL"));if(!(i.Device&&i.Device.toString().toUpperCase().includes(a.Device&&a.Device.toUpperCase()||"")&&n&&(i.PremiumStatus&&i.PremiumStatus.toString().toUpperCase()).includes(a.PremiumStatus&&a.PremiumStatus.toUpperCase()||"")))return r;if(e.updateUserStage&&o&&0<o.length&&(n=a.VisitedStages.indexOf(o[0]),e={userStageId:i.StageID,userStageDateTime:new Date,productCD:i.ProductCD},-1!=n?a.VisitedStages[n]=e:a.VisitedStages.push(e),Profile.isStorageEnabled)&&localStorage.setItem(Profile.profileStorageKey,JSON.stringify(a)),i.IsBackend&&conductBackendExperiment(a.UserId,i.ExprId,i.culture,i.logTraits,i.includeIterableIntegration,i.skipGoverning,t),window.experiment){if(r=window.experiment.conductUserExperiment(a.UserId,a.LayerId,i.ExprId).variant||0,experimentIdentityCall(a.UserId,i.exprName,i.variantDetails,r),t&&"function"==typeof t&&t(r),Profile.isMagenta)return r}else var l=setInterval(function(){if(void 0!==window.experiment&&(clearInterval(l),r=window.experiment.conductUserExperiment(a.UserId,a.LayerId,i.ExprId).variant||0,experimentIdentityCall(a.UserId,i.exprName,i.variantDetails,r),t&&"function"==typeof t&&t(r),Profile.isMagenta))return r},50)},window.Profile.UpdateUserPremiumStatus=function(e){var t;e&&Profile.isStorageEnabled&&((t=JSON.parse(localStorage.getItem(Profile.profileStorageKey))).PremiumStatus=e,localStorage.setItem(Profile.profileStorageKey,JSON.stringify(t)))},window.Profile.UpdateStage=function(t,r=""){var e,i,a;Profile.isStorageEnabled&&(a=(e=JSON.parse(localStorage.getItem(Profile.profileStorageKey))).VisitedStages.filter(function(e){return e.userStageId==t&&(""===r||_equalsIgnoreCase(e.productCD,r))}),i={userStageId:t,userStageDateTime:new Date,productCD:r},0<a.length?(a=e.VisitedStages.indexOf(a[0]),e.VisitedStages[a]=i):e.VisitedStages.push(i),localStorage.setItem(Profile.profileStorageKey,JSON.stringify(e)))},window.Profile.UpdateLoginStatus=function(e){var t;Profile.isStorageEnabled&&((t=JSON.parse(localStorage.getItem(Profile.profileStorageKey))).Role=e?"User":"Guest",localStorage.setItem(Profile.profileStorageKey,JSON.stringify(t)))},window.Profile.UpdateProfile=function(t,r){var e,i,a=window.Profile.BaseUrl+(window.Profile.APISlug||"/eb/api")+"/v1/users/experimentprofile";-1<window.location.hostname.indexOf("local")&&window.Profile.localURL&&(a=window.Profile.localURL+"/v1/users/experimentprofile"),Profile.isMagenta?(a=window.globalCompVars.BaseApiUrl+"users/experimentprofile",e=0,i=setInterval(async function(){"undefined"!=typeof MsgUtil&&MsgUtil&&(clearInterval(i),PS.APIEncryption.callAjax(a,"GET",!1,!0,!0,!0,function(e){e&&(e=JSON.parse(e),t.VisitedStages=e.userStageLogs,t.PremiumStatus=e.premiumStatus,t.TrialPurchaseDate=e.trialPurchaseDate),Profile.isStorageEnabled&&localStorage.setItem(Profile.profileStorageKey,JSON.stringify(t)),r&&"function"==typeof r&&r()},!1)),10<e&&clearInterval(i),e++},500)):callAjaxExpProfile(a,"GET",!1,!0,function(e){e&&(e=JSON.parse(e),t.VisitedStages=e.userStageLogs,t.PremiumStatus=e.premiumStatus,t.TrialPurchaseDate=e.trialPurchaseDate),Profile.isStorageEnabled&&localStorage.setItem(Profile.profileStorageKey,JSON.stringify(t)),r&&"function"==typeof r&&r()},!1)},window.Profile.UpdateTrialPurchaseDate=function(e){var t;Profile.isStorageEnabled&&((t=JSON.parse(localStorage.getItem(Profile.profileStorageKey))).TrialPurchaseDate=e,Profile.isStorageEnabled)&&localStorage.setItem(Profile.profileStorageKey,JSON.stringify(t))},window.Profile.CheckStageEligibility=function(t,r=""){var e,i,a=!0;return a=Profile.isStorageEnabled&&(e=(Profile.isStorageEnabled?JSON.parse(localStorage.getItem(Profile.profileStorageKey)):{}).VisitedStages.filter(function(e){return e.userStageId==t&&(""===r||_equalsIgnoreCase(e.productCD,r))}))&&0<e.length&&e[0].userStageDateTime&&(i=new Date,Math.round((i-new Date(e[0].userStageDateTime))/864e5)<14)?!1:a},window.Profile.CheckStgEligibilityAndReturnProfile=function(e,t=""){return{eligibility:window.Profile.CheckStageEligibility(e,t),UserProfile:Profile.isStorageEnabled?JSON.parse(localStorage.getItem(Profile.profileStorageKey)):null}},conductBackendExperiment=function(e,t,r,i=!0,a=!0,o=!0,n){var l,s,u=window.Profile.BaseUrl+(window.Profile.APISlug||"/eb/api")+"/v2/users/"+e+"/experiments/"+t+"/conduct";-1<window.location.hostname.indexOf("local")&&window.Profile.localURL&&(u=window.Profile.localURL+"/v2/users/"+e+"/experiments/"+t+"/conduct"),Profile.isMagenta?(u=window.globalCompVars.BaseApiUrlV2+"users/"+e+"/experiments/"+t+"/conduct",l=0,s=setInterval(async function(){"undefined"!=typeof MsgUtil&&MsgUtil&&(clearInterval(s),PS.APIEncryption.callAjax(u,"POST",!1,!0,!0,!0,n,!1,JSON.stringify(payload))),10<++l&&clearInterval(s)},500)):callAjaxExpProfile(u,"POST",!1,!0,n,!1,JSON.stringify({logTraits:i,conductForOldUsers:!0,includeIterableIntegration:a,culture:r,skipGoverning:o}))},setDefaultValues=function(e){return e.hasOwnProperty("PremiumStatus")||(e.PremiumStatus=["Not Started","Expired"]),e.hasOwnProperty("IsBackend")||(e.IsBackend=!1),e.hasOwnProperty("Country")||(e.Country=["ALL"]),e.hasOwnProperty("Device")||(e.Device="Desktop"),e.hasOwnProperty("culture")||(e.culture="en-US"),e.hasOwnProperty("ignoreStageCheck")||(e.ignoreStageCheck=!1),e},callAjaxExpProfile=function(e,t,r,i,a,o,n){var l=new XMLHttpRequest;l.onload=function(){4==l.readyState&&200==l.status?a&&(o?a(l.responseText,o):a(l.responseText)):4==l.readyState&&500==l.status&&a&&a("")},l.open(t,e,r),i&&(l.withCredentials=!0),n?(l.setRequestHeader("Content-Type","application/json;charset=UTF-8"),l.send(n)):l.send()},checktrialPurchaseDate=function(e){var t,r;return!e||(t=!1,r=new Date,14<Math.round((r-new Date(e))/864e5))||t},experimentIdentityCall=function(i,a,o,e){if(o&&0<Object.keys(o).length&&a){o=o[e];if(o){let e={["Experiment: "+a]:o},t=0,r=setInterval(()=>{"undefined"!=typeof TrackEvents&&"undefined"!=typeof analytics&&(clearInterval(r),TrackEvents("identify",e,i)),200<++t&&clearInterval(r)},100)}}};